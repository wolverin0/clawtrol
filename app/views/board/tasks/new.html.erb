<%= turbo_frame_tag "new_task_modal" do %>
  <div class="fixed inset-0 z-50 flex items-center justify-center" data-controller="modal" data-action="keydown.esc->modal#close">
    <div class="absolute inset-0 bg-black/60" data-action="click->modal#close"></div>
    <div class="relative bg-neutral-900 border border-neutral-800 rounded-lg shadow-xl w-full max-w-md mx-4">
      <div class="flex items-center justify-between px-4 py-3 border-b border-neutral-800">
        <h2 class="text-sm font-semibold text-white">New Task</h2>
        <%= link_to board_path, class: "text-neutral-500 hover:text-white transition-colors" do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
          </svg>
        <% end %>
      </div>

      <%= form_with model: @task, url: board_tasks_path, class: "p-4 space-y-4" do |form| %>
        <% if @task.errors.any? %>
          <div class="p-3 bg-red-900/30 text-red-400 text-xs rounded-md">
            <ul class="list-disc list-inside">
              <% @task.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <div>
          <%= form.label :name, "Task name", class: "block text-xs font-medium text-neutral-500 mb-1" %>
          <%= form.text_field :name, required: true, autofocus: true, placeholder: "What needs to be done?", class: "w-full px-3 py-2 text-sm bg-neutral-800 border border-neutral-700 rounded-md text-white placeholder:text-neutral-500 focus:outline-none focus:ring-1 focus:ring-orange-500 focus:border-orange-500" %>
        </div>

        <div>
          <%= form.label :description, "Description", class: "block text-xs font-medium text-neutral-500 mb-1" %>
          <%= form.text_area :description, rows: 3, placeholder: "Add more details...", class: "w-full px-3 py-2 text-sm bg-neutral-800 border border-neutral-700 rounded-md text-white placeholder:text-neutral-500 focus:outline-none focus:ring-1 focus:ring-orange-500 focus:border-orange-500 resize-none" %>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <%= form.label :priority, "Priority", class: "block text-xs font-medium text-neutral-500 mb-1" %>
            <%= form.select :priority, Task.priorities.keys.map { |p| [p.capitalize, p] }, {}, class: "w-full px-3 py-2 text-sm bg-neutral-800 border border-neutral-700 rounded-md text-white focus:outline-none focus:ring-1 focus:ring-orange-500 focus:border-orange-500" %>
          </div>

          <div>
            <%= form.label :status, "Status", class: "block text-xs font-medium text-neutral-500 mb-1" %>
            <%= form.select :status, Task.statuses.keys.map { |s| [s.titleize, s] }, {}, class: "w-full px-3 py-2 text-sm bg-neutral-800 border border-neutral-700 rounded-md text-white focus:outline-none focus:ring-1 focus:ring-orange-500 focus:border-orange-500" %>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <%= form.check_box :blocked, class: "rounded border-neutral-600 bg-neutral-800 text-orange-500 focus:ring-orange-500 focus:ring-offset-neutral-900" %>
          <%= form.label :blocked, "Mark as blocked", class: "text-sm text-neutral-300" %>
        </div>

        <div class="flex items-center justify-end gap-2 pt-2">
          <%= link_to "Cancel", board_path, class: "px-3 py-2 text-xs font-medium text-neutral-400 hover:text-white transition-colors" %>
          <%= form.submit "Create Task", class: "px-4 py-2 text-xs font-medium rounded-md bg-orange-500 text-white hover:bg-orange-600 transition-colors cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
