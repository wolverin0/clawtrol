<%= turbo_frame_tag @frame_id do %>
  <div class="h-full flex flex-col">
    <!-- Diff Viewer Header -->
    <div class="flex items-center justify-between px-4 py-3 border-b border-border flex-shrink-0">
      <div class="flex items-center gap-2 min-w-0">
        <span class="text-sm">üìä</span>
        <span class="text-sm font-medium text-content truncate" title="<%= @file_path %>">
          <%= File.basename(@file_path) %>
        </span>
        <span class="text-[10px] text-yellow-400 font-medium bg-yellow-500/20 px-1.5 py-0.5 rounded">DIFF</span>
        <% if @diff_source.present? %>
          <span class="text-[10px] text-content-muted font-mono">(<%= @diff_source %>)</span>
        <% end %>
      </div>
      <div class="flex items-center gap-1 flex-shrink-0">
        <button type="button"
                data-action="click->file-viewer#expand"
                class="cursor-pointer p-1.5 rounded-lg text-content-muted hover:text-content hover:bg-bg-elevated transition-colors"
                title="Expand diff viewer">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9m11.25-5.25v4.5m0-4.5h-4.5m4.5 0L15 9m-11.25 11.25v-4.5m0 4.5h4.5m-4.5 0L9 15m11.25 5.25v-4.5m0 4.5h-4.5m4.5 0L15 15" />
          </svg>
        </button>
        <button type="button"
                data-action="click->file-viewer#close"
                class="cursor-pointer p-1.5 rounded-lg text-content-muted hover:text-content hover:bg-bg-elevated transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Diff Content -->
    <div class="flex-1 overflow-y-auto px-5 py-4">
      <% if @file_error.present? %>
        <div class="flex items-center justify-center py-12">
          <div class="text-center">
            <span class="text-3xl mb-3 block">‚ö†Ô∏è</span>
            <p class="text-sm text-red-400"><%= @file_error %></p>
          </div>
        </div>
      <% elsif @diff_error.present? %>
        <div class="flex items-center justify-center py-12">
          <div class="text-center">
            <span class="text-3xl mb-3 block">‚ö†Ô∏è</span>
            <p class="text-sm text-orange-400"><%= @diff_error %></p>
          </div>
        </div>
      <% elsif @no_changes %>
        <div class="flex items-center justify-center py-12">
          <div class="text-center">
            <span class="text-3xl mb-3 block">‚ú®</span>
            <p class="text-sm text-content-muted">No changes detected</p>
            <p class="text-xs text-content-muted mt-1">File has no uncommitted changes or recent commits</p>
          </div>
        </div>
      <% elsif @diff_content.present? %>
        <div class="diff-content text-xs font-mono bg-bg-elevated rounded-lg overflow-x-auto">
          <%= @diff_content.html_safe %>
        </div>
      <% end %>
    </div>

    <!-- File path footer -->
    <div class="px-4 py-2 border-t border-border flex-shrink-0">
      <span class="text-[10px] font-mono text-content-muted"><%= @file_path %></span>
    </div>
  </div>
<% end %>
