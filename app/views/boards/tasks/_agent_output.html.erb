<%# Agent output partial - renders from TaskRun or falls back to description parsing %>
<% output_text = task.agent_output_text %>
<% if output_text.present? %>
  <div class="prose prose-invert prose-sm max-w-none break-words">
    <%= safe_markdown(output_text) %>
  </div>
<% elsif task.description.to_s.include?("## Agent Output") %>
  <%# Legacy fallback for tasks without TaskRun %>
  <% legacy_output = task.description_section("Agent Output") %>
  <% if legacy_output %>
    <div class="prose prose-invert prose-sm max-w-none break-words">
      <%= safe_markdown(legacy_output.to_s.strip) %>
    </div>
  <% end %>
<% end %>
