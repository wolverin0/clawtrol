<div id="<%= dom_id(proposal) %>" class="bg-bg-elevated border border-border rounded-xl p-4 hover:border-accent/30 transition-colors">
  <div class="flex items-start justify-between gap-4">
    <div class="min-w-0">
      <div class="flex items-center gap-2 flex-wrap">
        <h2 class="text-base font-semibold text-content truncate"><%= proposal.title %></h2>
        <span class="text-xs px-2 py-0.5 rounded-full bg-bg-base border border-border text-content-muted"><%= proposal.target_file %></span>
        <% status_style = case proposal.status
           when "pending" then "text-yellow-400"
           when "approved" then "text-green-400"
           when "rejected" then "text-red-400"
         end %>
        <span class="text-xs <%= status_style %>">‚óè <%= proposal.status.capitalize %></span>
        <% if proposal.proposed_by.present? %>
          <span class="text-xs text-content-muted">by <%= proposal.proposed_by %></span>
        <% end %>
      </div>

      <div class="mt-2">
        <% if proposal.diff_preview.present? %>
          <pre class="text-xs text-content-muted bg-bg-base border border-border rounded-lg p-3 whitespace-pre-wrap max-h-52 overflow-auto"><%= proposal.diff_preview %></pre>
        <% else %>
          <p class="text-sm text-content-secondary"><%= truncate(proposal.proposed_content, length: 280) %></p>
        <% end %>
      </div>

      <% if proposal.rejected? && proposal.reason.present? %>
        <div class="mt-2 text-xs text-red-400">Reason: <%= proposal.reason %></div>
      <% end %>
    </div>

    <div class="flex items-center gap-2">
      <% if proposal.pending? %>
        <%= button_to "Approve",
            approve_learning_proposal_path(proposal),
            method: :post,
            form: { data: { turbo_stream: true } },
            class: "text-xs px-3 py-1.5 rounded-lg bg-green-600 hover:bg-green-700 text-white font-medium transition-colors" %>
        <%= button_to "Reject",
            reject_learning_proposal_path(proposal),
            method: :post,
            form: { data: { turbo_stream: true } },
            class: "text-xs px-3 py-1.5 rounded-lg border border-border text-content-muted hover:text-content hover:border-accent/50 transition-colors" %>
      <% else %>
        <span class="text-xs text-content-muted uppercase tracking-wide"><%= proposal.status %></span>
      <% end %>
    </div>
  </div>
</div>
