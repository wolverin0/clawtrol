<%# Insert new task at the top of the today tasks list %>
<%= turbo_stream.prepend "tasks-list" do %>
  <%= render partial: "today/tasks/task", locals: { task: @task } %>
<% end %>

<%# Keep focus on add task input %>
<%= turbo_stream.append "tasks" do %>
  <script>
    (() => {
      setTimeout(() => {
        const input = document.querySelector('[data-add-task-target="input"]');
        if (input) {
          input.focus();
        }
      }, 100);
    })();
  </script>
<% end %>

<%# Update sidebar badges (inbox and today) %>
<%= render "application/sidebar_badges" %>
